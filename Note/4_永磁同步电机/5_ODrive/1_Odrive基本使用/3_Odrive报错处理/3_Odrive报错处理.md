# Engine 5.1.3 Odrive报错处理

如果 ODrive 不能按预期运行，请运行 `odrivetool` 并输入 `dump_errors(odrv0)`。 这将列出所有错误代码。

## `Axis` 错误

1. `ERROR_INVALID_STATE = 0x01`
   试图在不被允许的情况下切换状态。 通常是，在校准电机之前尝试运行编码器校准或闭环控制，或者在校准编码器之前尝试运行闭环控制。

2. `ERROR_DC_BUS_UNDER_VOLTAGE = 0x02`
   确认电源线已牢固连接。

3. `ERROR_DC_BUS_OVER_VOLTAGE = 0x04`
   确认电源电压和设置电压是否匹配。

## `Motor` 错误

1. `ERROR_PHASE_RESISTANCE_OUT_OF_RANGE = 0x0001` 和 `ERROR_PHASE_INDUCTANCE_OUT_OF_RANGE = 0x0002`
   在电机校准过程中，将测量电机电阻和电感。 如果测得的电机电阻或电感超出设定的正常范围，则会返回该错误。 请检查所有电机导线是否牢固连接。

2. `ERROR_MODULATION_MAGNITUDE = 0x0080`
   母线电压不足以使电机电流达到设定电流。如果在电机校准过程中出现这个错误，请确保`motor.config.resistance_calib_max_voltage`不超过总线电压的一半。

   > 对于云台电机，建议将`motor.config.calibration_current`和`motor.config.current_lim`设置为总线电压的一半或更低。

## `Encoder` 错误

1. `ERROR_CPR_OUT_OF_RANGE = 0x02`
   检查编码器的CPR和电机的磁极对数设置正确。
2. `ERROR_NO_RESPONSE = 0x04`
   确认编码器和ODrive连接正确。
3. `ERROR_INDEX_NOT_FOUND_YET = 0x20`
   确认编码器是具有索引脉冲的型号。同时确认编码器的索引信号输出引脚正确连接到ODrive。

## `Controller` 错误

1. `ERROR_OVERSPEED = 0x01`
   尝试增大`<axis>.controller.config.vel_limit`。 

## 其他可能不会产生错误代码的问题

1. 电机在高速旋转时会中断或失控(i> 5000 RPM)
   转速可能超过了编码器转速的极限。 实际上，ODrive 默认的2400计数/旋转编码器实际上被限制在5000 RPM左右。 超过此速度会导致 ODrive 失去位置反馈。 这只能通过更换转速极限更高的编码器或将电机的输出通过减速器连接到编码器上来解决。 如果使用减速器来提高编码器的转速极限，请修改编码器相应的参数。

2. 静止时电机振动或发出噪音

   - 可能因为 `vel_gain` 设置的过高。

   - 检查编码器轴的连接。 平头螺丝可能会随着时间的流逝而振动。 如果使用 CUI 轴编码器，请尝试重新安装塑料固定环，并确认其未与编码器外壳接触。 还要确认编码器已牢固安装。

   - 如果使用的是高分辨率编码器（> 4000个计数/旋转），那么增加`encoder_pll_bandwidth`可能有助于减少振动。

   - 如果将电机连接到具有较大惯性的负载（例如飞轮），这将在控制增益较高时有助于减少振动。 但是，请确保所有连接都是紧密的。 廉价的联轴器或皮带会在系统中引入很多间隙，从而使电动机仍然可以独立的振动。

3. 电机位置控制出现过冲或在目标位置震荡
     - 可能是由于 `pos_gain` 设置的太高。
     - 增加电机电流限制值以获取更大的转矩。
4. 电机开始缓慢旋转
   - 编码器反馈信号可能已丢失。电机急停或剧烈振动导致连接松动，可能会发生这种情况。
5. 电机输出的扭矩比应有的小或者电机在没有负载的情况下发热
   - 编码器的连接可能松动了，导致电机控制器换向错误，从而降低了输出转矩，并在电机试图保持位置时产生了过多的热量。
   - 如果转子在电机的轴上打滑，也可能导致这种情况。 在某些电机上，转子通过平头螺钉固定在轴上。 确认该螺丝足够紧。